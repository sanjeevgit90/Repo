<ng-container>
  <!-- Filter -->
  <div class="row">
    <div class="col-md-6">
      <ng-container *ngIf="isFilterable" [matColumnDef]="this.rowActionIcon">
        <!-- <input placeholder="Search" class="form-control"
          [placeholder]="'Search'" #searchInput>
          <input matInput (keyup)="applyFilter($event)" placeholder="Search">
        -->
        

        <div class="col-md-5">
          <div class="input-group">
            <input class="form-control border-end-0 border" type="search" placeholder="{{'GLOBAL_SEARCH' | translate }}"
              #searchInput>
            <span class="input-group-append" *ngIf="!isServerSidePagination">
              <app-buttons [btnType]="'button'" [isLabel]="false" [cssClass]="'search-icon'" [isIcon]="true"
                [maticon]="'bi bi-search'" (click)="applyFilter(searchInput.value)">
              </app-buttons>
            </span>
            <span class="input-group-append" *ngIf="isServerSidePagination">
              <app-buttons [btnType]="'button'" [isLabel]="false" [cssClass]="'search-icon'" [isIcon]="true"
                [maticon]="'bi bi-search'" (click)="callback.emit(searchInput.value)">
              </app-buttons>
            </span>
          </div>
        </div>
      </ng-container>
    </div>

    <div class="col-md-6 count font-weight-bold" *ngIf="recordCount">
      <span>{{'GLOBAL_TOTAL_COUNT' | translate}} : </span> {{recordCount}}
    </div>
  
  </div>

  <div class="table-responsive">



    <!-- Table -->
    <table class="mat-elevation-z8 table-theme" mat-table [dataSource]="tableDataSource" matSort
      (matSortChange)="sortTable($event)">




      <ng-container [matColumnDef]="serialNumberDisplay">
        <th mat-header-cell *matHeaderCellDef>
          {{GLOBAL_COLUMN_NAMES.SR_NO | translate}}
        </th>
        <td mat-cell *matCellDef="let element; let i=index">
          {{ element[GLOBAL_COLUMN_NAMES.SERIAL_NUMBER] }}
        </td>
      </ng-container>
      
      <ng-container *ngFor="let tableColumn of tableColumns ; index as i" [matColumnDef]="tableColumn.name">

        <!-- if sortable column header -->
        <ng-container *ngIf="tableColumn.isSortable; else notSortable">
          <th mat-header-cell *matHeaderCellDef [mat-sort-header]="tableColumn.name"
            [arrowPosition]="tableColumn.position === 'right' ? 'before' : 'after'">
            {{tableColumn.name | translate}}
          </th>
        </ng-container>
        <!-- else not sortable -->
        <ng-template #notSortable>
          <th mat-header-cell *matHeaderCellDef [class.text-right]="tableColumn.position == 'right'">
            {{tableColumn.name | translate}}
          </th>
        </ng-template>

        <!-- column data -->

        <td mat-cell *matCellDef="let element" [class.text-right]="tableColumn.position == 'right'">

          <ng-container *ngIf="tableColumn.dataKey.includes('status') === true">
            <div *ngIf="isWorkflowMaster">
              <span *ngIf="element[tableColumn.dataKey] === 1" class="text-primary">Draft</span>
              <span *ngIf="element[tableColumn.dataKey] === 2" class="text-danger">Submitted</span>
              <span *ngIf="element[tableColumn.dataKey] === 3" class="text-warning">Pending for Approval</span>
              <span *ngIf="element[tableColumn.dataKey] === 4" class="text-success">Approved</span>
              <span *ngIf="element[tableColumn.dataKey] === 5" class="text-success">Rejected</span>
            </div>
            <div *ngIf="!isWorkflowMaster">
              <span *ngIf="element[tableColumn.dataKey] === 1" class="text-green1">Active</span>
              <span *ngIf="element[tableColumn.dataKey] === 0" class="text-red">In-Active</span>
            </div>
          </ng-container>

          <ng-container *ngIf="tableColumn.dataKey.includes('workflowStatus') === true">
            <span *ngIf="element[tableColumn.dataKey] === 3" class="text-warning"> Pending for Approval</span>
          </ng-container>

          <ng-container
            *ngIf="tableColumn.dataKey.includes('status') === false && tableColumn.name.includes('Documents') === false">
            {{ getLimitedText(element[tableColumn.dataKey]) }}<a class="text-decoration-underline pointer "
              *ngIf="element[tableColumn.dataKey]?.length>255" (click)="openDialog(element[tableColumn.dataKey])">Read
              More</a>
          </ng-container>

          <ng-container *ngIf="tableColumn.name.includes('Documents') === true">
            <a href="{{ element[tableColumn.dataKey] }}" target="_blank">View Document</a>
          </ng-container>



        </td>

      </ng-container>
      <!-- action column -->

      <ng-container *ngIf="rowActionIcon?.length" [matColumnDef]="rowActionIcon">
        <th mat-header-cell *matHeaderCellDef>{{'GLOBAL_ACTION'| translate}}</th>
        <td mat-cell *matCellDef="let element; let i =index; let last = last" [id]="rowActionIcon">
          <ng-container mat-icon-button *ngFor="let action of allActions;">


            <ng-container *ngIf="action.action == actionList.VIEW_ACTION">
              <span *ngIf="accessRights?.isView">
                <button mat-flat-button color="primary" matTooltip="{{ action.toolTip }}"
                  (click)="onActionClick(action.action, element)" class="tableActionIcon me-2">
                  <mat-icon role="button">
                    {{ action.icon }}
                  </mat-icon>
                </button>
              </span>
            </ng-container>

            <ng-container *ngIf="action.action == actionList.MANAGE_MATERIAL_ACTION">
              <span *ngIf="accessRights?.isView">
                <button mat-flat-button color="primary" matTooltip="{{ action.toolTip }}"
                  (click)="onActionClick(action.action, element)" class="tableActionIcon me-2">
                  <mat-icon role="button">
                    {{ action.icon }}
                  </mat-icon>
                </button>
              </span>
            </ng-container>
            <ng-container *ngIf="action.action == actionList.EDIT_ACTION || action.action == actionList.EDIT_DBT">
              <!-- <mat-icon role="button" matTooltip="{{action.toolTip}}" (click)="onActionClick(action.action, element)"
              class="tableActionIcon"
              [ngStyle]="{'pointer-events': ((element.status === 1) && (action.action === 'edit_action')) ? 'auto' : (excludeEditFromStatus?'auto':((action.action === 'edit_action')?'none':'auto'))}">{{
              action.icon
              }}</mat-icon> -->
              <!-- Commented on 30-11-23
            <button mat-flat-button color="primary" matTooltip="{{ action.toolTip }}"
              (click)="onActionClick(action.action, element)" class="tableActionIcon me-2"
              [disabled]="(element.status === 1 && action.action === 'edit_action') ? false : (excludeEditFromStatus ? false : (action.action === 'edit_action' ? true : false))">
              <mat-icon role="button">
                {{ action.icon }}
              </mat-icon>
            </button> -->
              <!-- <h1>{{action.action}}</h1> -->
              <span *ngIf="accessRights?.isEdit">
                <!-- {{element[tableColumn.dataKey] === 5}} -->
                <span *ngIf="isWorkflowMaster">
                  <button mat-flat-button color="primary" matTooltip="{{ action.toolTip }}" *ngIf="element.status==workflowStatus.REJECT || element.status==workflowStatus.DRAFT"
                    (click)="onActionClick(action.action, element)" class="tableActionIcon me-2">
                    <mat-icon role="button">
                      {{ action.icon }}
                    </mat-icon>
                  </button>
                </span>

                <span *ngIf="!isWorkflowMaster">
                  <button mat-flat-button color="primary" matTooltip="{{ action.toolTip }}"
                    (click)="onActionClick(action.action, element)" class="tableActionIcon me-2"
                    [disabled]="((element.status == 1 || element.status == 3) && action.action === 'edit_action') ? false : (excludeEditFromStatus ? false : (action.action === 'edit_action' ? true : false))">
                    <mat-icon role="button">
                      {{ action.icon }}
                    </mat-icon>
                  </button>
                </span>
              </span>

            </ng-container>


            <ng-container *ngIf="action.action == actionList.DELETE_ACTION">
              <span>
                <button mat-flat-button color="primary" matTooltip="{{ action.toolTip }}"
                  (click)="onActionClick(action.action, element)" class="tableActionIcon me-2">
                  <mat-icon role="button">
                    {{ action.icon }}
                  </mat-icon>
                </button>
              </span>
            </ng-container>

            <ng-container *ngIf="action.toggleIcons && (element.status+'')">
              <span *ngIf="accessRights?.isDelete">
                <button mat-flat-button color="warn" *ngIf="(element.status === 0) && (action.toggleIcons.active)"
                  matTooltip="{{action.toggleToolTip.active}}" (click)="onActionClick(action.action, element)"
                  class="tableActionIcon me-2">
                  <mat-icon>{{
                    action.toggleIcons.active }}</mat-icon>
                </button>

                <button mat-flat-button color="warn" style="background-color: #2EB73D;"
                  *ngIf="(element.status === 1) && (action.toggleIcons.deactive)"
                  matTooltip="{{action.toggleToolTip.deactive}}" (click)="onActionClick(action.action, element)"
                  class="tableActionIcon me-2">
                  <mat-icon>{{
                    action.toggleIcons.deactive }}</mat-icon>
                </button>
              </span>
            </ng-container>

            <ng-container *ngIf="action.action == actionList.UNLOCK_ACTION">
              <span>
                <button mat-flat-button color="warn"
                  *ngIf="(element.failureAttemptCount === 0) || (element.failureAttemptCount < 5)"
                  matTooltip="{{action.toggleLockUnlockToolTip.lock}}" (click)="onActionClick(action.action, element)"
                  class="tableActionIcon me-2">
                  <mat-icon>{{
                    action.toggleLockUnlock.lock }}</mat-icon>
                </button>

                <button mat-flat-button color="warn" style="background-color: #2EB73D;"
                  *ngIf="element.failureAttemptCount === 5" matTooltip="{{action.toggleLockUnlockToolTip.unlock}}"
                  (click)="onActionClick(action.action, element)" class="tableActionIcon me-2">
                  <mat-icon>{{
                    action.toggleLockUnlock.unlock }}</mat-icon>
                </button>
              </span>
            </ng-container>




            <ng-container *ngIf="action.toggleArrowIcons">
              <button mat-flat-button color="warn" style="background-color: #f5b916;" *ngIf="i==0"
                matTooltip="{{ action.toggleArrowToolTip.down }}" (click)="onActionClick(actionList.DOWN, element)"
                class="tableActionIcon">
                <mat-icon>
                  {{ action.toggleArrowIcons.down }}
                </mat-icon>
              </button>

              <button mat-flat-button color="warn" style="background-color: #a7aa03;" *ngIf="i>0 && !last"
                matTooltip="{{action.toggleArrowToolTip.up}}" (click)="onActionClick(actionList.UP, element)"
                class="tableActionIcon me-2">
                <mat-icon>
                  {{ action.toggleArrowIcons.up }}
                </mat-icon>
              </button>

              <button mat-flat-button color="warn" style="background-color: #f5b916;" *ngIf="i>0 && !last"
                matTooltip="{{action.toggleArrowToolTip.down}}" (click)="onActionClick(actionList.DOWN, element)"
                class="tableActionIcon me-2">
                <mat-icon>
                  {{ action.toggleArrowIcons.down }}
                </mat-icon>
              </button>

              <button mat-flat-button color="warn" *ngIf="last" matTooltip="{{ action.toggleArrowToolTip.up }}"
                (click)="onActionClick(actionList.UP, element)" class="tableActionIcon me-2"
                style="background-color: #a7aa03;">
                <mat-icon>
                  {{ action.toggleArrowIcons.up }}
                </mat-icon>
              </button>

            </ng-container>


            <!-- <h1>{{action | json}}</h1> -->
          </ng-container>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
    <div *ngIf="recordCount==0" class="border p-3">
      {{'GLOBAL_NO_RECORD_FOUND' | translate}}
    </div>

  </div>

  <!-- Pagination -->

  <mat-paginator #clientPaginator *ngIf="isPageable && !isServerSidePagination" [pageSizeOptions]="paginationSizes"
    [pageSize]="defaultPageSize" showFirstLastButtons>
  </mat-paginator>

  <mat-paginator #serverPaginator *ngIf="isPageable && isServerSidePagination" [pageSizeOptions]="paginationSizes"
    [pageSize]="defaultPageSize" (page)="onPageChange($event)" [length]="recordCount" showFirstLastButtons>
  </mat-paginator>

</ng-container>
<div class="modal fade" #dialogModal tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <app-dialog [dialogContent]="dialogDisplayContent" [dialogHeading]="'GLOBAL_CONFIRM_STATUS_UPDATE' | translate"
    [cssClass]="'modal-dialog-scrollable modal-lg'" [isAction]="false" [isSrNumber]="true"></app-dialog>
</div>